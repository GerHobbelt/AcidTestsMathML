<!doctype html>
<html>
 <head>
  <title>The MathML Acid3 test (description)</title>
  <meta charset="utf-8"/>
  <style type="text/css">
    .framed {
      border: 1px dashed grey;
      background: #ddd;
    }

  /* used in test 99 */
  math.test99 :first-child { font-size: 2em; }
  #test99 > mn { font-size: 4em; }
  </style>
 </head>
 <body>
  <h1>The MathML Acid3 test (description)</h1>

<h2>Introduction</h2>

<p>The MathML Acid3 test essentially relies on the classical Acid3 and just
modify the Javascript tests in order to verify some MathML features. Thus the
requirement to pass the MathML Acid3 is the same:</p>

<p style="border: 1px dotted black; padding: 1em; margin: 1em;">
To pass the test, a browser must use its default settings, the animation has to
be smooth, the score has to end on 100/100, and the final page has to look
exactly, pixel for pixel, like
<a href="reference.html">this reference rendering</a></p>

<p>The strategy
of the MathML Acid3 test is to let the browser layout MathML expressions
and to determine positions and sizes of elements via the
<code>getBoundingClientRect</code> Javascript function. This does not allow to
test features like colors or links, but these are already verified in the
MathML Acid2 test. In general, the MathML specification gives some freedom and
so the corresponding tests are not too strict: for example one test just
verifies that in an &lt;mfrac&gt; element, the numerator is above a
denominator and not precise coordinates or sizes.</p>

<p>Sometimes, a more accurate measurement is necessary. For that purpose,
the MathML Acid3 test uses a special Acid3MathML family made available as Web
fonts. These fonts contain characters used in the tests:
ASCII letters, mathematical alphanumeric Symbols (to test
<code>mathvariant</code>) and for some operators from the MathML Operator
Dictionary. Their sizes are given by the table below. Test 0 verifies that
these Web fonts are downloaded and retry several times.
</p>

<table style="margin-left: auto; margin-right: auto; text-align: center;"
       border="1">
  <caption>
    Acid3MathML fonts: size of characters
  </caption>
  <thead>
    <tr><th>Style</th><th>Width</th><th>Height</th>
      <th><math><mfrac><mi>Width</mi><mi>Height</mi></mfrac></math></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>bold-italic           </td><td>256</td><td>1024</td><td>1/4</td>
    </tr>
    <tr>
      <td>sans-serif-bold-italic </td><td>384</td><td>1024</td><td>3/8</td>
    </tr>
    <tr>
      <td>bold                   </td><td>512</td><td>1024</td><td>1/2</td>
    </tr>
    <tr>
      <td>bold script            </td><td>576</td><td>1024</td><td>9/16</td>
    </tr>
    <tr>
      <td>bold-fraktur           </td><td>640</td><td>1024</td><td>5/8</td>
    </tr>
    <tr>
      <td>sans-serif-bold        </td><td>704</td><td>1024</td><td>11/16</td>
    </tr>
    <tr>
      <td>italic                 </td><td>768</td><td>1024</td><td>3/4</td>
    </tr>
    <tr>
      <td>sans-serif-italic      </td><td>832</td><td>1024</td><td>13/16</td>
    </tr>
    <tr>
      <td>monospace              </td><td>896</td><td>1024</td><td>7/8</td>
    </tr>
    <tr>
      <td>normal                </td><td>1024</td><td>1024</td><td>1</td>
    </tr>
    <tr>
      <td>script                </td><td>1088</td><td>1024</td><td>17/16</td>
    </tr>
    <tr>
      <td>fraktur               </td><td>1152</td><td>1024</td><td>9/8</td>
    </tr>
    <tr>
      <td>sans-serif            </td><td>1216</td><td>1024</td><td>19/16</td>
    </tr>
    <tr>
      <td>double-struck         </td><td>1280</td><td>1024</td><td>5/4</td>
    </tr>
  </tbody>
</table>

<p>However, this is still not enough to get perfect measure and results might
depend on some screen resolution, default font size, whether the page is zoom
in/out, whether automatic screen resizing is used on some mobile platforms etc
Hence
the MathML Acid3 test uses only relative <code>em</code> measures. In test 0,
a <math><mi>baseSize</mi></math> value is determined for the current
font size of the page. This may vary according to zoom level or automatic
screen resizing. Next, the following approximate comparison functions are
used:</p>

<math display="block">
<mrow>
  <mi>almostLessThanAbs</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo>
</mrow>
<mo>⇔</mo>
<mrow>
  <mrow><mi>x</mi><mo>−</mo><mi>y</mi></mrow>
  <mo>&lt;</mo>
  <mi>ε</mi><mo>×</mo><mi>baseSize</mi>
</mrow>
</math>

<math display="block">
<mrow>
  <mi>almostLessThanRel</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo>
</mrow>
<mo>⇔</mo>
<mrow>
  <mn>2</mn>
  <mo>&#x2062;</mo>
  <mfrac>
    <mrow><mi>x</mi><mo>−</mo><mi>y</mi></mrow>
    <mrow>
      <mrow><mo>|</mo><mi>x</mi><mo>|</mo></mrow>
      <mo>+</mo>
      <mrow><mo>|</mo><mi>y</mi><mo>|</mo></mrow>
    </mrow>
  </mfrac>
  <mo>&lt;</mo>
  <mi>ε</mi>
</mrow>
</math>

<p>where <math><mi>ε</mi><mo>=</mo><mn>0.1</mn></math>. 
Hence
<math>
  <mi>almostLessThanAbs</mi>
  <mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo>
</math>
means that <math><mi>x</mi><mo>&lt;</mo><mi>y</mi></math> modulo a small error.
This error is "absolute" once the <math><mi>baseSize</mi></math> is fixed.
<math><mi>almostLessThanRel</mi></math>
is "relative" in the sense that the tolerance grows with the magnitude of
<math><mi>x</mi><mo>,</mo><mi>y</mi></math>.
As a rule of thumb, 
<math><mi>almostLessThanAbs</mi></math> is used to compare coordinates
(the tolerance should not depend on these coordinates)
while 
<math><mi>almostLessThanRel</mi></math> is used to compare
sizes or distances (the tolerance is larger for big or far away objects).
Rationale for the <math><mn>2</mn></math>: if
<math><mi>x</mi><mo>,</mo><mi>y</mi></math> are objects of size
<math><mi>S</mi></math> then

<math>
  <mrow>
    <mi>almostLessThanRel</mi>
    <mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo>
  </mrow>
  <mo>⇔</mo>
  <mrow><mi>x</mi><mo>−</mo><mi>y</mi></mrow>
  <mo>&lt;</mo>
  <mi>ε</mi><mo>×</mo><mi>S</mi>
</math> and this is equivalent to 
<math>
  <mrow>
    <mi>almostLessThanAbs</mi>
    <mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo>
  </mrow>
</math>
for the base size.
The value compared to <math><mi>ε</mi></math> is inspired from
the
<a href="https://en.wikipedia.org/wiki/Approximation_error">approximation
errors</a> but we accomodate the fact that the document base size
may vary (absolute case) or that we can not distinguish between the exact and
approximative values (relative case).
For convenience the following approximate equality functions are
also defined:</p>

<math display="block">
<mrow>
  <mi>almostEqualAbs</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo>
</mrow>
<mo>⇔</mo>
<mrow>
  <mrow>
    <mi>almostLessThanAbs</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo>
  </mrow>
  <mo>∧</mo>
  <mrow>
    <mi>almostLessThanAbs</mi><mo>(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo>)</mo>
  </mrow>
</mrow>
<mo>⇔</mo>
<mrow>
  <mrow><mo>|</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo>|</mo></mrow>
  <mo>&lt;</mo>
  <mi>ε</mi><mo>×</mo><mi>baseSize</mi>
</mrow>
</math>

<math display="block">
<mrow>
  <mi>almostEqualRel</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo>
</mrow>
<mo>⇔</mo>
<mrow>
  <mrow>
    <mi>almostLessThanRel</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo>
  </mrow>
  <mo>∧</mo>
  <mrow>
    <mi>almostLessThanRel</mi><mo>(</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo>)</mo>
  </mrow>
</mrow>
<mo>⇔</mo>
<mrow>
  <mn>2</mn>
  <mo>&#x2062;</mo>
  <mfrac>
    <mrow><mo>|</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo>|</mo></mrow>
    <mrow>
      <mrow><mo>|</mo><mi>x</mi><mo>|</mo></mrow>
      <mo>+</mo>
      <mrow><mo>|</mo><mi>y</mi><mo>|</mo></mrow>
    </mrow>
  </mfrac>
  <mo>&lt;</mo>
  <mi>ε</mi>
</mrow>
</math>

<p>Sometimes we want to tolerate even more errors
(e.g. tests to verify support for stretchy operators, which are not
always stretched perfectly by the classical TeX method) or want to 
be sure that two values are really distinct (e.g. the bottom coordinate of
a base and exponent in <code>msup</code>). The MathML Acid3 test uses a
parameter <math><mi>ẟ</mi><mo>=</mo><mn>0.25</mn></math> for that purpose
which should be understood as a fraction of some size (e.g. the base size).</p>

<p>Finally, the MathML tests are contained in a div of width 1000em and this is
assumed to be large enough so that automatic line breaking does not happen by
default. Of course, tests for the line breaking use narrower containers.</p>

<h3>Important Remarks</h3>

<ul>
<li>Test 10 contains invalid markup: this is on purpose and
    intended to check error handling!</li>

<li>
From the above discussion about the test approximation, the description below
will use "lower than", "smaller than", "nonzero" etc
to mean with a nonnegligible difference (expressed in term of
<math><mi>ẟ</mi></math>) while
"at most as low", "at most as large", "zero" etc will mean modulo some
small error (expressed in term of <math><mi>ε</mi></math>)</li>
</ul>

<h3>Test 0</h3>

<p>This is a very simple test to start with:</p>

<ul>
<li>The "JS required" message is removed.</li>
<li>Web fonts availability is verified several times.</li>
<li>The <math><mi>baseSize</mi></math> is computed.</li>
<li>The namespace URI on a <code>&lt;math&gt;</code> is tested and should be
<code>http://www.w3.org/1998/Math/MathML</code>.</li>
<li>Test that inline math (default)
  does not break (bottom of X and Y are aligned):
  <p class="framed">
    <math><mtext>X</mtext></math>
    <math><mtext>Y</mtext></math>
  </p>
</li>
<li>Test that display math (<code>display="block"</code>)
breaks (bottom of X is at most as low as top of Y):
      <p  class="framed">
        <math><mtext>X</mtext></math>
        <math display="block"><mtext>Y</mtext></math>
      </p>
</li>

</ul>

<h2>Bucket 1: Basic Presentation MathML Elements</h2>

<h3>Test 1 and 2: simple script elements</h3>

<p>These are tests for <code>&lt;mrow&gt;</code>, <code>&lt;msub&gt;</code>,
<code>&lt;msup&gt;</code>, <code>&lt;msubsup&gt;</code>,
<code>&lt;mover&gt;</code>, <code>&lt;munder&gt;</code>
and <code>&lt;munderover&gt;</code> (left to right):</p>

      <p  class="framed">
        <math>
          <mrow>
            <mtext>BASE</mtext>
          </mrow>
        </math>
        <math>
          <msub>
            <mtext>BASE</mtext><mtext>X</mtext>
          </msub>
        </math>
        <math>
          <msup>
            <mtext>BASE</mtext><mtext>X</mtext>
          </msup>
        </math>
        <math>
          <msubsup>
            <mtext>BASE</mtext><mtext>X</mtext><mtext>X</mtext>
          </msubsup>
        </math>
        <math>
          <mover>
            <mtext>BASE</mtext><mtext>X</mtext>
          </mover>
        </math>
        <math>
          <munder>
            <mtext>BASE</mtext><mtext>X</mtext>
          </munder>
        </math>
        <math>
          <munderover>
            <mtext>BASE</mtext><mtext>X</mtext><mtext>X</mtext>
          </munderover>
        </math>

<p>Test 1 verifies some sizes:</p>

<ul>
<li>The height of the <code>&lt;mrow&gt;</code>
  is less than the heights of the elements that have scripts
  attached to the BASE. The height of elements with one script is less
  than the height of the corresponding element with two scripts.
</li>

<li>When the scripts are positioned on the right of the
  base (<code>&lt;msub&gt;</code>,
  <code>&lt;msup&gt;</code>, <code>&lt;msubsup&gt;</code>),
  the width of these elements should be larger than the one of the
  <code>&lt;mrow&gt;</code>.</li>
<li>
 When the scripts are positioned above or
  below the base (<code>&lt;mover&gt;</code>, <code>&lt;munder&gt;</code>
  and <code>&lt;munderover&gt;</code>) the width of these elements should
  be the same as the width of the <code>&lt;mrow&gt;</code>.
</li>
</ul>

<p>Test 2: verifies some positions:</p>

<ul>
<li>The subscripts of <code>&lt;msub&gt;</code> and
<code>&lt;msubsup&gt;</code> should be lower than the base.
This is verified by testing that the top of the subscripts are lower
than the top of the base. Similarly, the test
checks that the supscripts of 
<code>&lt;msup&gt;</code> and <code>&lt;msubsup&gt;</code> are higher than
the base.</li>
<li>The sub/super scripts of
  <code>&lt;msub&gt;</code>,
  <code>&lt;msup&gt;</code>, <code>&lt;msubsup&gt;</code>
  should be placed on the right of the base. The test verifies that
  the right coordinate of the base is at most the left coordinate of the
  scripts.  
</li>
<li>The under/over scripts of
<code>&lt;mover&gt;</code>, <code>&lt;munder&gt;</code>
  and <code>&lt;munderover&gt;</code>
should be placed between the left and
right coordinates of the base. The test verifies that the
left coordinate of base is less at most the left coordinate of the scripts and
  similarly for the right coordinates.
</li>
<li>The under/over scripts of
<code>&lt;mover&gt;</code>, <code>&lt;munder&gt;</code>
  and <code>&lt;munderover&gt;</code>
should be placed above/below the base. The test verifies that
the top of the base is at most as low as the bottom of the overscripts.
Similarly for the underscripts.</li>
</ul>

<h3>Test 3: mfrac</h3>

<p>A simple test for the <code>&lt;mfrac&gt;</code> element, where
  numerator and denominator have the same size.</p>

      <p class="framed">
        <math>
          <mfrac>
            <mtext>X</mtext><mtext>Y</mtext>
          </mfrac>
        </math>
      </p>

<ul>
<li>Numerator and denominator should be vertical aligned: 
the test verifies that the left coordinate of the numerator
(respectively right coordinate) matches the left coordinate of the
denominator (respectively right coordinate).</li>
<li>Numerator should be above denominator
with enough space to draw the fraction bar. The test verifies that
the bottom of the numerator is at most as low as the top of the denumerator.
</li>
</ul>

<h3>Test 4: msqrt</h3>

<p>This test verifies some properties of the <code>&lt;msqrt&gt;</code>
element:</p>

<ul>
<li>The square root should be placed on the left. For that purpose we
  verify that the space on the left (the left coordinate of the
  child minus the left coordinate of the <code>&lt;msqrt&gt;</code>) is
  nonzero.
</li>
<li>The child should be inside the square root. The test verifies that
the bottom of the child is at most at low as the bottom of the square root
and similarly for the other coordinates.</li>
</ul>

      <p class="framed">
        <math>
          <msqrt><mtext>X</mtext></msqrt>
        </math>
      </p>

<h3>Test 5: mroot</h3>

<p>This test verifies the following properties of the <code>&lt;mroot&gt;</code>
element:</p>

<ul>
<li>The index should be higher than the base. The test checks that the
bottom of the index is higher than the bottom of the child.
</li>
<li>The index should be on the left of the base. The test checks that the
right coordinate of the index is at most the left coordinate of the child.</li>
</ul>

      <p class="framed">
        <math>
          <mroot><mtext>Y</mtext><mtext>X</mtext></mroot>
        </math>
      </p>

<h3>test 6: menclose (circle, box)</h3>

<p>This is a simple test to verify the support for the box and circle notations
of menclose. The test contains some nested menclose elements:
a mtext content,
framed with a menclose "box", circled by a menclose "circle", framed,
and finally circled again.</p>

<p>We assume here that the notations are drawn with
rectangle and ellipse whose axis are the text horizontal/vertical axis and
that the notations do not overlap. Hence the width and height of a menclose
"box" should be at least those its content. Simple math shows that the width and
height of the menclose "circle" should be at least
<math><msqrt><mn>2</mn></msqrt></math> times as large as its content.
With the previous nesting, the outermost menclose is 
<math>
  <msup><msqrt><mn>2</mn></msqrt><mn>2</mn></msup>
  <mo>=</mo><mn>2</mn>
</math>
times as large as the inner mtext. Hence
the test verifies the following properties:</p>

<ul>
<li>The mtext should be inside the menclose. This is verified by comparing the
top, bottom, left and right coordinates.</li>
<li>The outermost menclose should be at least twice as large as the child.
This is done by comparing the width.
</li>
</ul>

      <p class="framed">
        <math>
          <menclose notation="circle" id="test6_menclose">
            <menclose notation="box">
              <menclose notation="circle">
                <menclose notation="box">
                  <mtext id="test6_mtext">XXX</mtext>
                </menclose>
              </menclose>
            </menclose>
          </menclose>
        </math>
      <p>

<h3>test 7: menclose (equivalent constructions)</h3>

      <p>This test verifies a couple of equivalence for menclose
	constructions:</p>

<ul>
  <li>"radical" should be equivalent to msqrt</li>
  <li>"box" should be equivalent to "left right top bottom"</li>
  <li>"actuarial" should be equivalent to "top right"</li>
</ul>

  <p>The test only verifies that the size of equivalent constructions are equal.
    This is a bit lax and thus a rendering engine that does not implement
    menclose at all might actually pass the test. Hence an additional
    verification is done to exclude this case:
    the width of an msqrt should not be equal to the width of its content.</p>

      <p class="framed">
        <math>
          <msqrt id="test7_radical_ref"><mtext>XXX</mtext></msqrt>
        </math>
        <math>
          <menclose notation="radical" id="test7_radical">
            <mtext>XXX</mtext>
          </menclose>
        </math>
      </p>

      <p class="framed">
        <math>
          <menclose notation="left right top bottom" id="test7_box_ref">
            <mtext>XXX</mtext>
          </menclose>
        </math>
        <math>
          <menclose notation="box" id="test7_box">
            <mtext>XXX</mtext>
          </menclose>
        </math>
      </p>

      <p class="framed">
        <math>
          <menclose notation="top right" id="test7_actuarial_ref">
            <mtext>XXX</mtext>
          </menclose>
        </math>
        <math>
          <menclose notation="actuarial" id="test7_actuarial">
            <mtext>XXX</mtext>
          </menclose>
        </math>
      </p>

<h3>test 8: semantics (do not display annotations)</h3>

  <p>This test contains a semantics element with an mtext child annotated
    by annotation and annotation-xml elements of encoding "application/x-tex"
    and "application/xhtml+xml". It is assumed that a MathML rendering engine
    will just display the annotated mtext and hide the others. Hence the
    test verifies that the semantics size is the same as the mtext child.</p>

      <p class="framed">
        <math>
          <semantics id="test8_semantics">
            <mtext>X</mtext>
            <annotation encoding="application/x-tex">XXXXX</annotation>
            <annotation-xml encoding="application/xhtml+xml">
              <span>XXXXX</span>
            </annotation-xml>
          </semantics>
        </math>
      </p>

<h3>test 9: maction</h3>

<p>This is similar to test 8, except that an maction elements are used with
actiontype tooltip, statusline and toggle. In the two first cases, only the
first element must be visible. In the last case, the selection attribute is
used to display only the second element. As in test 8, we compare the size
of the expected visible child with the size of the maction element.</p>

<p class="framed">
        <math>
          <maction id="test9_maction1" actiontype="tooltip">
            <mtext>X</mtext>
            <mtext>tooltip</mtext>
          </maction>
        </math>
</p>
<p class="framed">
        <math>
          <maction id="test9_maction2" actiontype="statusline">
            <mtext>X</mtext>
            <mtext>statusline</mtext>
          </maction>
        </math>
</p>
<p class="framed">
        <math>
          <maction id="test9_maction3" actiontype="toggle" selection="2">
            <mtext>X</mtext>
            <mtext>selection</mtext>
          </maction>
        </math>
</p>

<h3>test 10: mrow, mstyle, mphantom</h3>

<p>This test contains a trivial verification about the mrow, mstyle and
mphantom elements. Basically, they should have the same size as their content:
</p>
      <p class="framed">
        <math>
          <mrow id="test10_mrow"><mtext>TEXT</mtext></mrow>
        </math>
      </p>
      <p class="framed">
        <math>
          <mstyle id="test10_mstyle"><mtext>TEXT</mtext></mstyle>
        </math>
      </p>
      <p class="framed">
        <math>
          <mphantom id="test10_mphantom"><mtext>TEXT</mtext></mphantom>
        </math>
      </p>

<p>These are combined with a less easy verification so that the whole test
  won't pass in browsers without MathML support. Basically we check that
  an msub with three mtext children generates an invalid markup message but
  not when the two first are grouped into an mrow. Again, we verify the
  difference by width comparison. We assume that the width of the text in
  the error message is negligible compared to the width of the mtext elements.
  For that purpose, the actual test contains long mtext string, rather than
  just one "X" as below.
</p>

      <p class="framed">
        <math>
          <msub id="test10_noerror">
            <mrow>
              <mtext>X</mtext>
              <mtext>X</mtext>
            </mrow>
            <mtext></mtext>
          </msub>
        </math>
      </p>
      <p class="framed">
      <math>
          <msub id="test10_error">
            <mtext>X</mtext>
            <mtext>X</mtext>
            <mtext>
              <!-- This msub element is intentionally invalid and should
                   render in a different way than test10_noerror -->
            </mtext>
          </msub>
        </math>
      </p>

<h3>test 11, 12: mtable (rows, cells)</h3>

<p>These are basic tests on an mtable of 3 rows and 3 columns.
Test 11 verifies metrics of mtr elements:</p>

<ul>
<li>mtable rows should have same height.</li>
<li>mtable rows should be aligned, that is the left/right coordinates of mtr
elements should match.</li>
<li>each row should be above its successor, that is the bottom of a mtr element
should be at most the top of its successor.</li>
</ul>

<p>Test 12 verifies metrics of mtd elements:</p>

<ul>
<li>The cells of a given column should be aligned, that is the left/right
coordinates of mtd elements should match.</li>
<li>The cells of a given row should be aligned, that is the top/bottom
coordinates of mtd elements should match.</li>
<li>Each column should be on the left of the next column. The test verifies
that the right coordinate of one cell in the column is at most the left
coordinate of one cell in the next column.</li>
<li>Similarly for rows, using the bottom/top coordinates</li>
</ul>

<p class="framed">
        <math>
          <mtable id="test11_mtable">
            <mtr>
              <mtd><mtext>X</mtext></mtd>
              <mtd><mtext>X</mtext></mtd>
              <mtd><mtext>X</mtext></mtd>
            </mtr>
            <mtr>
              <mtd><mtext>X</mtext></mtd>
              <mtd><mtext>X</mtext></mtd>
              <mtd><mtext>X</mtext></mtd>
            </mtr>
            <mtr>
              <mtd><mtext>X</mtext></mtd>
              <mtd><mtext>X</mtext></mtd>
              <mtd><mtext>X</mtext></mtd>
            </mtr>
          </mtable>
        </math>
</p>

<h3>test 13: mmultiscripts</h3>

<p>This test contains a mmultiscripts with
4 prescripts and 4 postscripts. The prescript at the top and right
as well as the postscript at the bottom right are &lt;none&gt; elements. All
the other scripts have the same size. The test verifies that:</p>

<ul>
<li>The &lt;none&gt; elements have zero size. This is done by checking that
  height times width is zero.</li>
<li>All the other scripts have the same size.</li>
<li>The horizontal positions of nonempty scripts are correct, that is the test
verify the left to right positioning of scripts. For example that the right
coordinate of the base is at most the left coordinate of a postscript.</li>
<li>The vertical alignment of nonempty scripts, that is the left
coordinates of some scripts should match.</li>
<li>The horizontal alignment of nonempty scripts. That is the top coordinate
of some scripts should match.</li>
<li>subscripts should be above supscripts, that is the bottom coordinate of
  a subscript is at most the top coordinate of a supscript.</li>
<li>subscripts/supscripts should be lower/higher than the base. Same as in
test 2.</li>
</ul>

<p class="framed">
        <math>
          <mmultiscripts id="test13_mmultiscripts">
            <mtext>X</mtext>
            <mtext>X</mtext><mtext>X</mtext>
            <none/><mtext>X</mtext>
            <mprescripts/>
            <mtext>X</mtext><mtext>X</mtext>
            <mtext>X</mtext><none/>
          </mmultiscripts>
        </math>
</p>

<h3>test 14: mspace</h3>

<p>This test contains two spaces of em dimensions
(width, height, depth) given by (5, 3, 2) and (15, 4, 6).
The test verifies that</p>

<ul>
<li>The widths of the spaces are given by 5 and 15 respectively.</li>
<li>The (CSS) height is the sum of the (mspace) height and depth, that is
  5 and 10 respectively.</li>
<li>The baseline alignement is correct. The test verifies the bottom of the
second space minus the bottom of the first space is the depth of the second
minus the depth of the first, that is 4.</li>
</ul>

      <p class="framed">
        <math id="test14">
          <mspace width="5em" height="3em" depth="2em" mathbackground="red"/>
          <mspace width="15em" height="4em" depth="6em" mathbackground="green"/>
        </math>
      </p>

<h3>test 15: mpadded</h3>

<p>This test contains four mpadded elements of em dimensions
(width, height, depth) given by (5, 3, 2), (15, 4, 6), (10, 20, 10) and
(3, 1.5, 1). The fourth is included in the third, with em shift
(lspace, voffset) given by (2, 2.5). The test verifies that:</p>

<ul>
<li>The sizes of the mpadded elements are correct</li>
<li>The first and second mpadded elements are correctly aligned
  (as in test 14).</li>
<li>The position of the fourth mpadded inside the third is correct.
That is the left coordinate of the inner mpadded minus the left coordinate
of the outer mpadded should be the lspace value. The top coordinate of the
inner mpadded minus the top coordinate of the outer mpadded should be 
the difference of (mspace) height minus the voffset.</li>
</ul>

      <p class="framed">
        <math id="test15">
          <mpadded width="5em" height="3em" depth="2em" mathbackground="blue"/>
          <mpadded width="15em" height="4em" depth="6em" mathbackground="red"/>
        </math>
        <math>
          <mpadded id="test15_mpadded"
                   width="10em" height="20em" depth="10em"
                   lspace="2em" voffset="2.5em" mathbackground="green">
            <mpadded width="3em" height="1.5em" depth="1em"
		     mathbackground="yellow">
            </mpadded>
          </mpadded>
        </math>
      </p>

<h3>test 16: ms, mi, mn</h3>

  <p>This test contains the following token elements:
    &lt;mtext&gt;X&lt;/mtext&gt;,
    &lt;ms lquote="XXX" rquote="XX"&gt;X&lt;/ms&gt;,
    &lt;mi&gt;X&lt;/mi&gt;,
    &lt;mi&gt;XX&lt;/mi&gt; and
    &lt;mn&gt;X&lt;/mn&gt;. The test verifies that:</p>

<ul>
<li>The width of the ms is 5 times the one of the mtext (three X's for rquote,
one inner X and two X's for the lquote).</li>
<li>The width of the ms and mtext are the same.</li>
<li>The width of the "XX" mi is twice the one of the mtext
  (mi with several characters are not slanted)</li>
<li>The width of the "X" mi is <math><mfrac><mn>3</mn><mn>4</mn></mfrac></math>
the one of the mtext (mi with one character is italic, the ratio is from the
table about Acid3MathML fonts)</li>
</ul>

      <p class="framed">
        <math>
          <mtext id="test16">X</mtext>
        </math>
        <math>
          <mrow id="test16mrow"><ms lquote="XXX" rquote="XX">X</ms></mrow>
        </math>
        <math>
          <mi id="test16mi">X</mi>
        </math>
        <math>
          <mi id="test16mi2">XX</mi>
        </math>
        <math>
          <mn id="test16mn">X</mn>
        </math>
      </p>

<h2>Bucket 2: More Advanced Presentation Attributes</h2>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>


<h2>Bucket 3: Displaystyle, Scriptlevel and Operators</h2>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h2>Bucket 4: More Features of Operators</h2>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h2>Bucket 5: Directionality and Linebreaking</h2>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>


<h2>Bucket 6: Alignment and Elementary Mathematics</h2>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h3></h3>

<p>...</p>

<h2>Other Special tests</h2>

<h3>Test 97</h3>

<p>This test verifies compatibility of MathML with Javascript. Initially, we
have an empty mstyle element:</p>

<pre>
  &lt;math&gt;
    &lt;mstyle id="test97"&gt;
    &lt;/mstyle&gt;
  &lt;/math&gt;
</pre>

<p>Then, the test performs the following operations:</p>

<ol>
<li>create an mo element</li>
<li>set the <code>textContent</code> of the mo to "|"</li>
<li>create an mi element</li>
<li>create an mtext element</li>
<li>create an mrow element</li>
<li>append the mo, mi and mtext in the mrow in that order. At that step,
you get
</li>
</ol>

<p>At that step, you get the following structure:</p>

<pre>
&lt;mrow&gt;
  &lt;mo&gt;|&lt;/mo&gt;
  &lt;mi&gt;&lt;/mi&gt;
  &lt;mtext&gt;&lt;/mtext&gt;
&lt;/mrow&gt;
</pre>

<p>Then the test performs the following operations:</p>
<ol>
<li>create an mspace element</li>
<li>set the height attribute of the mspace to "4em"</li>
<li>set the depth attribute of the mspace to "4em"</li>
<li>create an mpadded element</li>
<li>set the height attribute of the mspace to "0"</li>
<li>set the depth attribute of the mspace to "0"</li>
<li>insert the mspace element into the mpadded</li>
</ol>

<p>At that step, you get the following structure:</p>

<pre>
  &lt;mpadded height="0" depth="0"&gt;
    &lt;mspace depth="4em" height="4em"/&gt;
  &lt;/mpadded&gt;
</pre>

<p>Then the test performs the following operations:</p>
<ol>
<li>create an mstyle element</li>
<li>append the mpadded</li>
<li>append the mrow</li>
<li>remove the mi from the mrow</li>
<li>remove the depth and height attributes from the mpadded</li>
</ol>

<p>At that step, you get the following structure:</p>

<pre>
&lt;math&gt;
  &lt;mstyle id="test97"&gt;
    &lt;mrow&gt;
      &lt;mo&gt;|&lt;/mo&gt;
      &lt;mtext&gt;&lt;/mtext&gt;
    &lt;/mrow&gt;
    &lt;mpadded&gt;
      &lt;mspace depth="4em" height="4em"/&gt;
    &lt;/mpadded&gt;
  &lt;/mstyle&gt;
&lt;/math&gt;
</pre>

<p>Finally, the mrow becomes an embellished operator. The height of the
mpadded is the height of the mspace, that is 8em. Hence the test verifies
that the mo bar stretches to that size.</p>

<h3>Test 98</h3>

<p>This test verifies compatibility of MathML with SVG and HTML. A MathML
root is inserted inside an SVG image, rotated by 180°. The MathML element
contains an mover element, an mtext with embedded SVG and a semantics with
embedded HTML. The test checks:</p>

<ul>
<li>That the script of the mover element is below the base (<em>not</em> above,
the image is rotated by 180°!)</li>
<li>A total width obtained by summing those of the embedded SVG and HTML
fragment.</li>
</ul>

      <div class="framed">
        <svg width="30em" height="5em" viewBox="0 0 300 50">
          <g transform="translate(150,25) rotate(180) translate(-150,-25)">
            <switch>
              <foreignObject
                 requiredExtensions="http://www.w3.org/1998/Math/MathML" 
                 width="300px" height="50px">
                <math>
                  <mrow>
                    <mover mathcolor="green">
                      <mtext id="test98_A">A</mtext>
                      <mtext id="test98_B">B</mtext>
                    </mover>
                    <mtext id="test98_start">START</mtext>
                    <mtext>
                      <svg width="110px" height="20px">
                        <text fill="red" dy="20px">SVG</text>
                      </svg>
                    </mtext>
                    <semantics>
                      <mtext>
                        <span style="display: inline-block; color: blue;
                                     width: 70px;">HTML</span>
                      </mtext>
                      <annotation encoding="plain/text">D</annotation>
                    </semantics>
                    <mtext id="test98_end">END</mtext>
                  </mrow>
                </math>
              </foreignObject>
            </switch>
          </g>
        </svg>
      </div>

<p>Another test verifies the compatibility of MathML line breaking with the
CSS one. An inline formula is placed inside a table cell. This HTML table is
itself contained in a div of width 5em. Hence this will also be the cell width
and thus the one used by the MathML line breaking algorithm.
The formula contains
an mtext "ABC" (3em), a plus mo (1em) and an mtext "DEF" (3em) and so should
break. The test checks that the bottom of "ABC" is at most as low as the top
of "DEF".</p>

        <div class="framed" style="width: 5em;">
          <table>
            <tr>
              <td>
                <math>
                  <mtext id="test98_abc">ABC</mtext>
                  <mo>+</mo>
                  <mtext id="test98_def">DEF</mtext>
                </math>
              </td>
            </tr>
          </table>
        </div>




<h3>Test 99</h3>

<p>This test verifies compatibility of MathML with CSS using basic rules
that modify the font-size:</p>
<ul>
<li>The size of the X is set by
  <code>math.test99 :first-child { font-size: 2em; }</code>
</li>
<li>The size of the Y by a <code>style="font-size: 3em"</code> attribute.
</li>
<li>
  The size of the Z by
  <code>#test99 > mn { font-size: 4em; }</code>
</li>
</ul>

<p>Note that is really a pure CSS test (albeit nodes are MathML) and so
should even pass in browsers without MathML support.</p>

<p class="framed">
        <math class="test99" id="test99">
          <mtext>X</mtext>
          <mtext style="font-size: 3em">Y</mtext>
          <mn>Z</mn>
        </math>
</p>


 </body>
</html>
